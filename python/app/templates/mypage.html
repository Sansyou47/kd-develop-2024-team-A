<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Éû„Ç§„Éö„Éº„Ç∏</title>
    <link rel="stylesheet" href="../static/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    {% include "header.html" %}
</head>

<body class="flex flex-col min-h-screen bg-orange-100">
    <main>
        <div class="">
            <!-- „Éó„É≠„Éï„Ç£„Éº„É´ -->
            <!-- Ë¶ÅÁ¥†„ÇíÊ®™„Å´ÈÖçÁΩÆ -->
            <div class="flex justify-left mx-4 ">
                <!-- ÂÜÜÂΩ¢„ÅÆÊû†„Åß„Ç¢„Ç§„Ç≥„É≥ÁîªÂÉè -->
                <h1 class="rounded-full w-20 h-20 text-center bg-gray-500 ">
                    <img src="../static/images/CameraIcon.jpeg" alt="„Ç¢„Ç§„Ç≥„É≥ÁîªÂÉè" class="rounded-full w-20 h-20">
                </h1>
                <!-- Ë¶ÅÁ¥†„ÇíÁ∏¶„Å´ÈÖçÁΩÆ -->
                <div class="flex-col items-center ml-2 ">
                    <!-- user_name„Åå7ÊñáÂ≠ó‰ª•‰∏ä„ÅÆÂ†¥Âêà„ÄÅ7ÊñáÂ≠óÁõÆ‰ª•Èôç„ÅØ‚Ä¶„ÅßË°®„Åô -->
                    {% if session.user_name|length > 7 %}
                    <h2 class="text-3xl font-semibold">{{ session.user_name[:7] }}...</h2>
                    {% else %}
                    <h2 class="text-3xl font-semibold">{{ session.user_name }}</h2>
                    {% endif %}

                    <p class="text-sm underline decoration-slate-50 ">{{session.user_email}}</p>
                </div>
                <p class="flex justify-center items-center ml-4 text-lg text-blue-500 font-bold ">
                    <!-- /signup„Å´È£õ„Å∂ -->
                    <a href="/signup">
                        „Éë„Çπ„ÉØ„Éº„ÉâÂ§âÊõ¥
                    </a>
                </p>
            </div>
            <!-- „Éó„É≠„Éï„Ç£„Éº„É´ „Åä„Çè„Çä -->

            <div class="text-2xl font-bold text-center mt-4">
                sort_type:{{sort_type}} sort_direction:{{sort_direction}}
            </div>


            <div class="flex justify-left">
                <form action="/mypage" method="POST" id="sortForm">
                    <!-- sort_type„Ååscore„ÅÆÂ†¥Âêà„ÄÅÂàùÊúüÂÄ§„ÅØÁÇπÊï∞È†Ü„Å®„Å™„Çã -->
                    <select id="sortOrder" name="sort_type" onchange="document.getElementById('sortForm').submit()">
                        <option value="date" {% if sort_type=="date" %}selected{% endif %}> Êó•‰ªòÈ†Ü</option>
                        <option value="score" {% if sort_type=="score" %}selected{% endif %}>ÁÇπÊï∞È†Ü</option>
                        <option value="ü¶Ä" {% if sort_type=="ü¶Ä" %}selected{% endif %}>„Çø„É©„Éê„Ç¨„ÉãÈ†Ü</option>
                    </select>



                    <select id="sortDirection" name="sort_direction"
                        onchange="document.getElementById('sortForm').submit()">
                        <option value="desc" {% if sort_direction=="desc" %}selected{% endif %}>ÈôçÈ†Ü</option>
                        <option value="asc" {% if sort_direction=="asc" %}selected{% endif %}>ÊòáÈ†Ü</option>
                        <option value="ü¶Ä" {% if sort_direction=="ü¶Ä" %}selected{% endif %}>„Ç∫„ÉØ„Ç§„Ç¨„ÉãÈ†Ü</option>
                    </select>
                </form>
            </div>

            {% if mypage_result_zen %}
            <!-- Â±•Ê≠¥‰∏ÄË¶ß„Ç≥„É≥„ÉÜ„Éä -->
            <div id="bentoContainer" class="flex-col items-center">
                {% for score, bento_url, create_date in mypage_result_zen %}
                <!-- Â±•Ê≠¥Ë¶ÅÁ¥† -->
                <!--Ê®™ -->
                <div class="bento-item flex justify-left mx-8 my-2 rounded bg-white shadow-md" data-score="{{ score }}"
                    data-date="{{ create_date }}">
                    <h1 class="flex items-center justify-center mx-1 my-1 w-20 h-20 text-center">
                        <img src="{{ bento_url }}" alt="Bento Image">
                    </h1>
                    <!-- Á∏¶ -->
                    <div class="flex-col items-center ml-2 ">
                        <h2 class="text-sm font-semibold mt-2">
                            <!-- „ÅäÂºÅÂΩìÂêçÈÄ£Áï™ -->
                            „ÅäÂºÅÂΩì{{ loop.index + ((page - 1) * page_contents) }}
                        </h2>
                        <div class="flex justify-left">
                            <p class="text-4xl font-bold mt-2">
                                {{ score }}ÁÇπ
                            </p>
                            <p class="flex items-end ml-4 text-right text-xs">
                                {{ create_date }}
                            </p>
                        </div>
                    </div>

                </div>

                {% endfor %}
            </div>
            {% else %}
            <p>„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
            {% endif %}

            <!-- „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥„ÅÆ„É™„É≥„ÇØ -->
            <div class="flex flex-wrap justify-center items-center gap-1 p-4">
                <form action="/mypage" method="POST" class="m-2">
                    <input type="hidden" name="page" value="1">
                    <input type="hidden" name="sort_type" value="{{ sort_type }}">
                    <input type="hidden" name="sort_direction" value="{{ sort_direction }}">

                    <button type="submit"
                        class="w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center text-sm text-blue-500 bg-gray-200 hover:bg-gray-300 border border-gray-800 rounded-md">
                        << </button>
                </form>


                <!-- page-2„Åå0„Å´„Å™„ÇãÂ†¥Âêà„ÄÅË°®Á§∫„Åó„Å™„ÅÑ -->
                {% if page - 2 > 0 %}
                <form action="/mypage" method="POST" class="m-1">
                    <input type="hidden" name="page" value="{{ page - 2 }}">
                    <input type="hidden" name="sort_type" value="{{ sort_type }}">
                    <input type="hidden" name="sort_direction" value="{{ sort_direction }}">

                    <button type="submit"
                        class="w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center text-sm text-blue-500 bg-gray-200 hover:bg-gray-300 border border-gray-800 rounded-md">
                        {{ page - 2 }}
                    </button>
                </form>
                {% endif %}

                <!-- page-1„Åå0„Å´„Å™„ÇãÂ†¥Âêà„ÄÅË°®Á§∫„Åó„Å™„ÅÑ -->
                {% if page - 1 > 0 %}
                <form action="/mypage" method="POST" class="m-1">
                    <input type="hidden" name="page" value="{{ page - 1 }}">
                    <input type="hidden" name="sort_type" value="{{ sort_type }}">
                    <input type="hidden" name="sort_direction" value="{{ sort_direction }}">

                    <button type="submit"
                        class="w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center text-sm text-blue-500 bg-gray-200 hover:bg-gray-300 border border-gray-800 rounded-md">
                        {{ page - 1 }}
                    </button>
                </form>
                {% endif %}

                <!-- ÁèæÂú®„ÅÆ„Éö„Éº„Ç∏ -->
                <div class="m-1">
                    <button type="submit"
                        class="w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center text-sm text-black bg-gray-200 hover:bg-gray-300 border border-gray-800 rounded-md">
                        {{ page }}
                    </button>
                </div>
                <!-- ‰øùÂ≠ò„Åï„Çå„Å¶„ÅÑ„ÇãÂÖ®„Å¶„ÅÆ„ÅäÂºÅÂΩì„ÅÆ„Éá„Éº„ÇøÊï∞ÔºûÁèæÂú®„Éö„Éº„Ç∏*Ë°®Á§∫„Åï„Çå„Å¶„ÅÑ„Çã„ÅäÂºÅÂΩì„ÅÆ„Éá„Éº„ÇøÊï∞„ÄÄ„ÅÆ„Å®„Åç Ë°®Á§∫„Åô„Çã-->
                {% if mypage_data_size > page * page_contents %}
                <!-- „Éö„Éº„Ç∏„É≥„Ç∞„ÅÆÈöõ„Å´page„Å®sort_type„Å®sort_direction„ÇíPOST„ÅßÈÄÅ„Çã -->
                <form action="/mypage" method="POST" class="m-1">
                    <input type="hidden" name="page" value="{{ page + 1 }}">
                    <input type="hidden" name="sort_type" value="{{ sort_type }}">
                    <input type="hidden" name="sort_direction" value="{{ sort_direction }}">

                    <button type="submit"
                        class="w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center text-sm text-blue-500 bg-gray-200 hover:bg-gray-300 border border-gray-800 rounded-md">
                        {{ page + 1 }}
                    </button>
                </form>

                {% endif %}

                {% if mypage_data_size > page * page_contents + 5 %}
                <form action="/mypage" method="POST" class="m-1">
                    <input type="hidden" name="page" value="{{ page + 2 }}">
                    <input type="hidden" name="sort_type" value="{{ sort_type }}">
                    <input type="hidden" name="sort_direction" value="{{ sort_direction }}">

                    <button type="submit"
                        class="w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center text-sm text-blue-500 bg-gray-200 hover:bg-gray-300 border border-gray-800 rounded-md">
                        {{ page + 2 }}
                    </button>
                </form>
                {% endif %}
                <!-- ÊúÄÁµÇ„Éö„Éº„Ç∏ „Å´È£õ„Å∂-->
                <!-- ‰Ωô„Å£„Åü„Éö„Éº„Ç∏„Åå„Å™„ÅÑÂ†¥Âêà -->
                {% if mypage_data_size // page_contents == 0 %}
                <form action="/mypage" method="POST" class="m-2">
                    <input type="hidden" name="page" value="{{ mypage_data_size // page_contents }}">
                    <input type="hidden" name="sort_type" value="{{ sort_type }}">
                    <input type="hidden" name="sort_direction" value="{{ sort_direction }}">

                    <button type="submit"
                        class="w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center text-sm text-blue-500 bg-gray-200 hover:bg-gray-300 border border-gray-800 rounded-md">
                        >>
                    </button>
                </form>

                <!-- ‰Ωô„Çä„Éö„Éº„Ç∏„Åå„ÅÇ„ÇãÂ†¥Âêà -->
                {% else %}
                <form action="/mypage" method="POST" class="m-2">
                    <input type="hidden" name="page" value="{{ mypage_data_size // page_contents + 1 }}">
                    <input type="hidden" name="sort_type" value="{{ sort_type }}">
                    <input type="hidden" name="sort_direction" value="{{ sort_direction }}">

                    <button type="submit"
                        class="w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center text-sm text-blue-500 bg-gray-200 hover:bg-gray-300 border border-gray-800 rounded-md">
                        >>
                    </button>
                </form>
                {% endif %}
            </div>
            <!-- „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥„ÅÆ„É™„É≥„ÇØ „Åä„Çè„Çä -->
        </div>
    </main>
    {% include "footer.html" %}
    <!-- ÁîªÈù¢ÂÖ®‰Ωì„ÇíË¶Ü„ÅÜ„Ç™„Éº„Éê„Éº„É¨„Ç§„ÅÆË¶ÅÁ¥† -->
    <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden"></div>
    <script>

        function sortBentoData() {
            const date_point = document.getElementById('sortOrder').value;

            date_point.submit();
        }
        // function sortBentoData() {
        //     const container = document.getElementById('bentoContainer');
        //     const items = Array.from(container.getElementsByClassName('bento-item'));
        //     const sortOrder = document.getElementById('sortOrder').value;
        //     const sortDirection = document.getElementById('sortDirection').value;

        //     items.sort((a, b) => {
        //         let aValue, bValue;
        //         if (sortOrder === 'score') {
        //             aValue = parseInt(a.getAttribute('data-score'));
        //             bValue = parseInt(b.getAttribute('data-score'));
        //         } else {
        //             aValue = new Date(a.getAttribute('data-date'));
        //             bValue = new Date(b.getAttribute('data-date'));
        //         }

        //         if (sortDirection === 'asc') {
        //             return aValue - bValue;
        //         } else {
        //             return bValue - aValue;
        //         }
        //     });

        //     items.forEach(item => container.appendChild(item));
        // }
    </script>
</body>

</html>